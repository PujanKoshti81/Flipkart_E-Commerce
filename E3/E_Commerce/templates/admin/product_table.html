{% extends 'admin/home.html' %}


{% block title %}
<h1 class="page-header">Button Table <small>Welcome to the Button Table...</small></h1>
{% endblock %}
{% block content %} 
{% load static %}


<div class="row">
    <!-- begin col-12 -->
    <div class="col-lg-12">
            <!-- begin panel -->
            <div class="panel panel-inverse">
                <!-- begin panel-heading -->
                <div class="panel-heading">
                    <div class="panel-heading-btn">
                        <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                        <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>
                        <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                        <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                    </div>
                    <h4 class="panel-title">DataTable - Buttons</h4>
                </div>
                <!-- end panel-heading -->
                <!-- begin alert -->
             
                <!-- end alert -->
                <!-- begin panel-body -->
                <div class="panel-body">
                    <table id="data-table-buttons" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th width="1%">ID</th>
                                <th width="1%" data-orderable="false">img</th>
                                <th class="text-nowrap">Product name</th>
                                <th class="text-nowrap">Price</th>
                                <th class="text-nowrap">Platform(s)</th>
                                <th class="text-nowrap">Action</th>
                                <th class="text-nowrap" >  Engine version</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for pro in product_form %}

                            <tr class="odd gradeX">
                                <td width="1%" class="f-s-600 text-inverse">{{ pro.id }}</td>
                                <td width="1%" class="with-img"><img src="{{ pro.main_image_id.main_image }}" class="img-rounded height-30" /></td>
                                <td>{{ pro.product_name }}</td>
                                <td>{{pro.product_price}}</td>
                                <td>Win 95+</td>
                                <td class="with-btn"  >
                                    <a href="#" class="btn btn-sm btn-primary width-60 m-r-2">Delete</a>
                                    <a  onclick="edit({{ pro.id }})" class="btn btn-sm btn-white width-60">Edit</a>
                                    <a href="#"  data-toggle="dropdown"><i class="fa fa-2x fa-cog fa-spin" ></i></a>
                                    <ul class="dropdown-menu">
                                        <li><a href="#modal-message{{pro.id}}" onclick="set_name_of_id({{pro.id}})" data-toggle="modal"><i class="fa fa-lg fa-money" aria-hidden="true"></i><span> &nbsp;&nbsp; </span>Update Prices</a></li>
                                        <!-- <li><a href="#"><i class="fas fa-lg fa-edit"></i>Update Details</a></li> -->
                                        <!-- <li><a href="#"><i class="fas fa-lg fa-trash"></i>Delete</a></li> -->
                                        <li><a href="#modal-dialog{{pro.id}}" data-toggle="modal">&nbsp;&nbsp;<i class="fas fa-lg fa-dollar-sign"></i><span> &nbsp;&nbsp;&nbsp;&nbsp; </span>Costing</a></li>
                                    </ul>
                                </td>


                                    <!-- ============================================================================================== -->
                                
                                        <!-- #modal-message -->
                                        <div class="modal modal-message fade" id="modal-message{{pro.id}}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    

                                                    <form id="update_prices_of_{{pro.special_price_id.id}}" >
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Calculate different prices:</h4>
                                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                                        </div>
                                                        <div class="modal-body">
                                                            {% csrf_token %}

                                                            <!-- Brand Name -->
                                                            <div class="form-group row m-b-15">
                                                                <h1><input type="text"class="col-form-label col-md-3" hidden id="id_of_{{pro.id}}" value="{{pro.special_price_id.id}}" ></h1>
                                                                <label class="col-form-label col-md-3"><legend>Labels :</legend></label>
                                                                <label class="col-form-label col-md-3"><legend>Actual Price :</legend></label>
                                                                <label class="col-form-label col-md-3"><legend>Sale Price :</legend></label>
                                                            </div>
                                                            <!-- Brand Name -->
                                                            <div class="form-group row m-b-15">
                                                                <label class="col-form-label col-md-3">per gm price :</label>
                                                                <div class="col-md-3">
                                                                    <input type="number" name="actual_per_gm" onkeyup="add_actual_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.actual_per_gm}}">
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <input type="number" name="sale_per_gm" onkeyup="add_sale_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.sale_per_gm}}">
                                                                </div>
                                                            </div>
                                                            <!-- Brand Name -->
                                                            <div class="form-group row m-b-15">
                                                                <label class="col-form-label col-md-3">Total pcs price :</label>
                                                                <div class="col-md-3">
                                                                    <input type="number" name="actual_total_pcs_price" onkeyup="add_actual_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.actual_total_pcs_price}}">
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <input type="number" name="sale_total_pcs_price" onkeyup="add_sale_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.sale_total_pcs_price}}">
                                                                </div>
                                                            </div>
                                                            <!-- Brand Name -->
                                                            <div class="form-group row m-b-15">
                                                                    <label class="col-form-label col-md-3">Packing cost :</label>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="actual_pckg_cost" onkeyup="add_actual_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.actual_pckg_cost}}">
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="sale_pckg_cost" onkeyup="add_sale_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.sale_pckg_cost}}">
                                                                    </div>
                                                                </div>
                                                                <!-- Brand Name -->
                                                                <div class="form-group row m-b-15">
                                                                    <label class="col-form-label col-md-3">Parcel cost :</label>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="actual_parcel_cost" onkeyup="add_actual_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.actual_parcel_cost}}">
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="sale_parcel_cost" onkeyup="add_sale_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.sale_parcel_cost}}">
                                                                    </div>
                                                                </div>
                                                                <!-- Brand Name -->
                                                            <div class="form-group row m-b-15">
                                                                    <label class="col-form-label col-md-3">Other cost :</label>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="actual_other_cost" onkeyup="add_actual_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.actual_other_cost}}">
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <input type="number" name="sale_other_cost" onkeyup="add_sale_price(this.value,{{pro.special_price_id.id}})" class="form-control m-b-5" value="{{pro.special_price_id.sale_other_cost}}">
                                                                    </div>
                                                                </div>
                                                                <!-- Brand Name -->
                                                                <div class="form-group row m-b-15">
                                                                    <label class="col-form-label col-md-3">Total price :</label>
                                                                    <div class="col-md-3">
                                                                        <input type="number" readonly id="actual_total_price_{{pro.special_price_id.id}}" name="actual_total_price" class="form-control m-b-5" value="{{pro.special_price_id.actual_total_price}}" >
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <input type="number" readonly id="sale_total_price_{{pro.special_price_id.id}}" name="sale_total_price" class="form-control m-b-5" value="{{pro.special_price_id.sale_total_price}}">
                                                                    </div>
                                                                </div>

                                                            <hr>

                                                            <div class="form-group row  m-b-15">
                                                                <label class="col-md-3 col-form-label">Strike price :</label>
                                                                <div class="col-md-2">
                                                                    <input type="number" name="strike_price" class="form-control m-b-3" value="{{pro.special_price_id.strike_price}}">
                                                                </div>
                                                                <div class="row row-space-10">
                                                                    <div class="col-xs-2">
                                                                        <input type="text" onfocus="(this.type='date')"  onblur="(this.type='text')" class="form-control" name="strike_start" placeholder="{{pro.special_price_id.strike_start}}" />
                                                                    </div>
                                                                    <h5>To</h5>
                                                                    <div class="col-xs-2">
                                                                        <input  type="text" onfocus="(this.type='date')"  onblur="(this.type='text')" class="form-control" name="strike_end" placeholder="{{pro.special_price_id.strike_end}}" />
                                                                    </div>
                                                                </div>
                                                            </div>  
                                                        </div>
                                                        <div class="modal-footer">
                                                            <a href="javascript:;"  class="btn btn-sm btn-white" data-dismiss="modal">Close</a>
                                                            <input type="button" value="Save Changes" onclick="update_price({{pro.special_price_id.id}})" class="btn btn-sm btn-primary">
                                                        </div>
                                                   
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    
                                    <!-- ============================================================================================== -->
                                        <!-- #modal-message -->
                                        <div class="modal modal-message fade" id="modal-dialog{{pro.id}}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <legend>
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Calculate prices for Returned products :</h4>
                                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                                        </div>
                                                    </legend>
                                                    <div class="modal-body">
                                                        
                                                    <!-- Brand Name -->
                                                    <div class="form-group row m-b-15">
                                                        <label class="col-form-label col-md-5"><h5>Basic Price :</h5></label>
                                                    </div>
                                                    
                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3">Per gm price :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                            <div class="col-md-3">
                                                                <input type="number" readonly name="brand_name" class="form-control m-b-5" placeholder="Product pcs weight">
                                                            </div>
                                                            <div class="col-md-3">
                                                                Upload sale time 
                                                                <div class="switcher">
                                                                        <input type="checkbox" name="upload_sale_time_per_gm_price" id="switcher_checkbox_55"  >
                                                                        <label for="switcher_checkbox_55"></label>
                                                                    </div>
                                                            </div>
                                                        </div>


                                                         <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-5"><h5>Overhead Expenses :</h5></label>
                                                        </div>
                                                        
                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3">i) Shipping Cost :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                            <div class="col-md-3">
                                                                Api integration time get 
                                                                <div class="switcher">
                                                                        <input type="checkbox" name="upload_sale_time_per_gm_price" id="switcher_checkbox_25"  >
                                                                        <label for="switcher_checkbox_25"></label>
                                                                    </div>
                                                            </div>
                                                            <div class="col-md-3">
                                                                Upload sale time 
                                                                <div class="switcher">
                                                                        <input type="checkbox" name="upload_sale_time_per_gm_price" id="switcher_checkbox_35"  >
                                                                        <label for="switcher_checkbox_35"></label>
                                                                    </div>
                                                            </div>
                                                        </div>

                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3">ii) Photo Cost :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                           
                                                        </div>

                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3">iii) Packing Cost :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                            <div class="col-md-3">
                                                                Upload sale time 
                                                                <div class="switcher">
                                                                        <input type="checkbox" name="upload_sale_time_per_gm_price" id="switcher_checkbox_45"  >
                                                                        <label for="switcher_checkbox_45"></label>
                                                                    </div>
                                                            </div>
                                                            
                                                        </div>

                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3">iv) Other Cost :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                            <div class="col-md-3">
                                                                Upload sale time 
                                                                <div class="switcher">
                                                                        <input type="checkbox" name="upload_sale_time_per_gm_price" id="switcher_checkbox_65"  >
                                                                        <label for="switcher_checkbox_65"></label>
                                                                    </div>
                                                            </div>
                                                            
                                                        </div>
                                                        <hr>
                                                        <!-- Brand Name -->
                                                        <div class="form-group row m-b-15">
                                                            <label class="col-form-label col-md-3"> Total Cost :</label>
                                                            <div class="col-md-3">
                                                                <input type="number" readonly name="brand_name" class="form-control m-b-5" placeholder="">
                                                            </div>
                                                        </div>


                                                        <hr>
                                                        <!-- ============================================================================== -->

                                                    </div>
                                                    <div class="modal-footer">

                                                        <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal">Close</a>
                                                        <input type="button" value="Save Changes" class="btn btn-sm btn-primary"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    <!-- ============================================================================================== -->
                                   

                                   

                                <td nowrap="">4</td>
                            </tr>
                            {% endfor %}
                            
                       

                           
                        </tbody>
                    </table>
                </div>
                <!-- end panel-body -->
            </div>
            <!-- end panel -->
        </div>
    <!-- end col-10 -->
</div>







<script type="text/javascript">

    //=========== UPDATE PRODUCT PRICE ==============================
    function add_actual_price(num,id){
        
        var total = document.getElementById('actual_total_price_'+id);
        if(num == NaN || num == ''){
            total.value = parseInt(total.value) + 0;    
        }
        else{
            total.value = parseInt(total.value) + parseInt(num);
        }
    }

    function add_sale_price(num,id){
        
        var total = document.getElementById('sale_total_price_'+id);
        if(num == NaN || num == ''){
            total.value = parseInt(total.value) + 0;    
        }
        else{
            total.value = parseInt(total.value) + parseInt(num);
        }
    }

    function update_price(id){
        var idd = '#update_prices_of_'+id;
        $.ajax({
            url:'/update_product_price/',
            type:'POST',
            data:$(idd).serialize(),
            dataType:'JSON',
            success: function(result){
                if(result.response){
                    alert("Prices updated successfully!!!");
                }
                else{
                    alert('PLEASE AGAIN SELECT THE STARTING AND ENDING STRIKE DATE !!!');
                }
            },
            failure: function(){}
        });
    }

    function set_name_of_id(id){
        var namee = document.getElementById('id_of_'+id);
        namee.name = "special_price_id";
    }

    //========================================================================


    function edit(id) {
        swal({
    title: 'Are you sure?',
    text: 'You won\'t be able to revert this!',
    type: 'warning',
    showCancelButton: true,
    confirmButtonColor: '#00c0ef',
    cancelButtonColor: '#ff8080',
    confirmButtonText: 'Yes, Edit it!'
    }).then(function () {
    window.location.href="/edit_product/?id="+id;

    });
    }
</script>

{% endblock %}